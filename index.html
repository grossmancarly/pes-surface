<script>
    let xMin = -0.2, xMax = 5, yMin = -0.2, yMax = 5, steps = 100;
    let zMax = 5;
    let showHeatmap = true;

    // Reaction Coordinate Functions (parametric equations)
    function integralV(t) {
        let result = 0;
        const dx = (t - 5) / steps; // Small step size for integration
        for (let i = 0; i < steps; i++) {
            let x = 5 + i * dx; // Calculate x values within the integration bounds
            result += (Math.sqrt(x ** 4 + 1) / (x ** 2)) * dx; // Trapezoidal integration
        }
        return result;
    }

    function X(t, k, a, h, c, p) {
        return 1 + k * Math.exp(-((t - a) ** 2) / h - ((1 / t - 1 / a) ** 2) / h) +
            c * (1 + Math.exp(-p * (1 / t - 1 / a))) ** -1;
    }

    function generateReactionCoordinateData(k, a, c, p, h) {
        let x = [], V = [];
        for (let i = 0; i < steps; i++) {
            let t = xMin + (xMax - xMin) * i / (steps - 1); // Parametric t
            let Vt = integralV(t); // Compute V(t)
            let Xt = X(t, k, a, h, c, p); // Compute X(t)

            x.push(Xt);
            V.push(Vt);
        }
        return { x, V };
    }

    function updatePlot() {
        let k = parseFloat(document.getElementById("EaSlider").value);
        let sliderValue = parseFloat(document.getElementById("aSlider").value);
        let c = parseFloat(document.getElementById("cSlider").value);
        let a = transformSliderValue(sliderValue);
        let h = 0.5; // Arbitrary value for parameter h
        let p = 5;   // Arbitrary value for parameter p

        let reactionCoordinateData = generateReactionCoordinateData(k, a, c, p, h);

        let reactionCoordinatePlot = {
            type: 'scatter',
            x: reactionCoordinateData.x,
            y: reactionCoordinateData.V,
            mode: 'lines',
            line: { color: 'blue' }
        };

        let layoutReactionCoordinate = {
            title: "Reaction Coordinate vs. V",
            xaxis: { title: "Reaction Coordinate (X(t))" },
            yaxis: { title: "V (Integral of Potential Energy)" },
            height: 400,
            margin: { l: 50, r: 50, b: 50, t: 50 }
        };

        Plotly.newPlot('plot-reaction-coordinate', [reactionCoordinatePlot], layoutReactionCoordinate);
    }

    updatePlot();
</script>
